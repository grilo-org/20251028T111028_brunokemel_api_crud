# API de UsuÃ¡rios - FastAPI

Esta Ã© uma API REST completa desenvolvida com FastAPI, SQLAlchemy e MySQL, que permite gerenciar usuÃ¡rios com operaÃ§Ãµes CRUD completas, autenticaÃ§Ã£o JWT e sistema de seguranÃ§a robusto.

## ğŸš€ Tecnologias

- **FastAPI** - Framework web moderno e rÃ¡pido para Python
- **Uvicorn** - Servidor ASGI para execuÃ§Ã£o da aplicaÃ§Ã£o
- **SQLAlchemy** - ORM para interaÃ§Ã£o com banco de dados
- **Pydantic v2** - ValidaÃ§Ã£o e serializaÃ§Ã£o de dados
- **MySQL** - Sistema de gerenciamento de banco de dados relacional
- **JWT** - AutenticaÃ§Ã£o com tokens seguros
- **Bcrypt** - Criptografia de senhas
- **OAuth2** - Sistema de autenticaÃ§Ã£o padrÃ£o

## ğŸ“ Estrutura do Projeto

```
ğŸ“¦ api_py/
â”œâ”€â”€ ğŸ“ app/
â”‚   â”œâ”€â”€ ğŸ“ core/                 # ConfiguraÃ§Ãµes principais
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ config.py         # ConfiguraÃ§Ãµes da aplicaÃ§Ã£o e banco
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ security.py       # AutenticaÃ§Ã£o JWT e seguranÃ§a
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ __init__.py       # InicializaÃ§Ã£o do mÃ³dulo core
â”‚   â”‚   â””â”€â”€ ğŸ“œ example_usage.py  # Exemplos de uso das funcionalidades
â”‚   â”œâ”€â”€ ğŸ“ routers/              # Rotas da API
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ __init__.py
â”‚   â”‚   â””â”€â”€ ğŸ“œ users.py          # Rotas de usuÃ¡rios
â”‚   â”œâ”€â”€ ğŸ“œ main.py               # Ponto de entrada da aplicaÃ§Ã£o
â”‚   â”œâ”€â”€ ğŸ“œ models.py             # Modelos do banco de dados (SQLAlchemy)
â”‚   â”œâ”€â”€ ğŸ“œ database.py           # ConfiguraÃ§Ã£o e conexÃ£o com o banco
â”‚   â”œâ”€â”€ ğŸ“œ schemas.py            # Schemas Pydantic para validaÃ§Ã£o
â”‚   â””â”€â”€ ğŸ“œ crud.py               # OperaÃ§Ãµes CRUD do banco de dados
â”œâ”€â”€ ğŸ“ tests/                    # Testes automatizados
â”‚   â””â”€â”€ ğŸ“œ test_users.py
â”œâ”€â”€ ğŸ“œ requirements.txt          # DependÃªncias do projeto
â”œâ”€â”€ ğŸ“œ credenciais.env           # VariÃ¡veis de ambiente (nÃ£o versionado)
â”œâ”€â”€ ğŸ“œ .gitignore               # Arquivos ignorados pelo Git
â””â”€â”€ ğŸ“œ README.md                # DocumentaÃ§Ã£o do projeto
```

## ğŸ› ï¸ InstalaÃ§Ã£o e ExecuÃ§Ã£o

### PrÃ©-requisitos
- Python 3.8+
- pip (gerenciador de pacotes do Python)
- MySQL Server instalado e configurado

### Passos para instalaÃ§Ã£o

1. **Clone o repositÃ³rio:**
   ```bash
   git clone https://github.com/brunokemel/api_crud.git
   cd api_crud
   ```

2. **Configure o banco MySQL:**
   - Crie um banco de dados chamado `cadastro_db`
   - Crie o arquivo `credenciais.env` com as seguintes variÃ¡veis:
     ```env
     DB_USER=seu_usuario
     DB_PASSWORD=sua_senha
     DB_HOST=localhost
     DB_NAME=cadastro_db
     
     # ConfiguraÃ§Ãµes JWT
     SECRET_KEY=sua_chave_secreta_muito_segura_aqui
     ALGORITHM=HS256
     ACCESS_TOKEN_EXPIRE_MINUTES=30
     ```

3. **Instale as dependÃªncias:**
   ```bash
   pip install -r requirements.txt
   ```

4. **Use Python 3.12.7 ou use vitualizaÃ§Ã£o com a versÃ£o**(Para compatibilidade com rust https://rustup.rs/ instale localmente se necessario)
````bash
  py -3.12 -m venv venv    
  > .\venv\Scripts\activate
````

5. **Execute a aplicaÃ§Ã£o:**
   ```bash
   uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
   uvicorn app.main:app --reload
   ```

6. **Acesse a documentaÃ§Ã£o interativa:**
   - Swagger UI: http://127.0.0.1:8000/docs
   - ReDoc: http://127.0.0.1:8000/redoc
   - API Base: http://127.0.0.1:8000

## ğŸ“¸ Interface da API

<img width="1414" height="636" alt="image" src="https://github.com/user-attachments/assets/c82d26f7-edbf-4455-a294-0cca4c48f1c4" />

**Acesse a documentaÃ§Ã£o interativa:** @http://127.0.0.1:8000/docs

## ğŸ“‹ Endpoints da API

### UsuÃ¡rios

#### Criar UsuÃ¡rio
- **POST** `/users/`
- **Body:**
  ```json
  {
    "nome": "JoÃ£o Silva",
    "email": "joao@email.com",
    "cpf": "123.456.789-00"
  }
  ```

#### Listar UsuÃ¡rios
- **GET** `/users/`
- **Resposta:** Lista de todos os usuÃ¡rios cadastrados

#### Atualizar UsuÃ¡rio
- **PUT** `/users/{user_id}`
- **Body:**
  ```json
  {
    "nome": "JoÃ£o Silva Atualizado",
    "email": "joao.novo@email.com",
    "cpf": "123.456.789-00"
  }
  ```

#### Deletar UsuÃ¡rio
- **DELETE** `/users/{user_id}`
- **ParÃ¢metros:** `user_id` (ID do usuÃ¡rio a ser deletado)

### AutenticaÃ§Ã£o (Em Desenvolvimento)

#### Login
- **POST** `/token`
- **Body:**
  ```json
  {
    "username": "usuario@email.com",
    "password": "senha123"
  }
  ```

#### Rotas Protegidas
- Todas as rotas de usuÃ¡rios podem ser protegidas com autenticaÃ§Ã£o JWT
- Use o token retornado no login no header: `Authorization: Bearer <token>`

## ğŸ—„ï¸ Modelo de Dados

### User
- `id` (Integer, Primary Key) - Identificador Ãºnico
- `nome` (String, 100 chars) - Nome do usuÃ¡rio
- `email` (String, 100 chars, Unique) - Email Ãºnico do usuÃ¡rio
- `cpf` (String, 14 chars, Unique) - CPF Ãºnico do usuÃ¡rio

## ğŸ”§ Funcionalidades

### âœ… Implementadas
- **CRUD Completo** - Criar, ler, atualizar e deletar usuÃ¡rios
- **ValidaÃ§Ã£o de Dados** - Pydantic v2 para validaÃ§Ã£o robusta
- **Banco de Dados MySQL** - PersistÃªncia com SQLAlchemy
- **DocumentaÃ§Ã£o AutomÃ¡tica** - Swagger UI e ReDoc integrados
- **ConfiguraÃ§Ãµes Centralizadas** - Sistema core modular
- **SeguranÃ§a JWT** - AutenticaÃ§Ã£o com tokens (infraestrutura pronta)
- **Criptografia de Senhas** - Bcrypt para seguranÃ§a
- **Pool de ConexÃµes** - OtimizaÃ§Ã£o de performance do banco

### ğŸš§ Em Desenvolvimento
- **Sistema de Login** - Endpoint de autenticaÃ§Ã£o
- **ProteÃ§Ã£o de Rotas** - Middleware de autenticaÃ§Ã£o
- **Gerenciamento de SessÃµes** - Refresh tokens

## ğŸ” Sistema de SeguranÃ§a

### ConfiguraÃ§Ãµes JWT
- **Algoritmo:** HS256
- **ExpiraÃ§Ã£o:** 30 minutos (configurÃ¡vel)
- **Chave Secreta:** Definida em `credenciais.env`

### Criptografia
- **Senhas:** Hash bcrypt com salt automÃ¡tico
- **Tokens:** Assinatura digital JWT
- **ConexÃµes:** SSL/TLS para banco de dados

## ğŸ“ Notas Importantes

- âš ï¸ **Crie o banco MySQL** `cadastro_db` antes da execuÃ§Ã£o
- ğŸ”‘ **Configure o arquivo** `credenciais.env` com suas credenciais
- ğŸ”’ **Mantenha a SECRET_KEY segura** - nunca commite no Git
- ğŸ“Š **ValidaÃ§Ã£o automÃ¡tica** de dados de entrada e saÃ­da
- ğŸ“š **DocumentaÃ§Ã£o interativa** disponÃ­vel em `/docs` e `/redoc`
- ğŸ§ª **Testes automatizados** disponÃ­veis na pasta `tests/`

## ğŸš€ PrÃ³ximas Funcionalidades

- [ ] Sistema completo de autenticaÃ§Ã£o
- [ ] Refresh tokens
- [ ] Middleware de autorizaÃ§Ã£o
- [ ] Logs estruturados
- [ ] Rate limiting
- [ ] Testes de integraÃ§Ã£o
- [ ] Docker containerization
- [ ] CI/CD pipeline

---

## ğŸ“„ HistÃ³rico de VersÃµes

### v2.0.0 - Sistema Core Implementado
- âœ… ConfiguraÃ§Ã£o modular com `app/core/`
- âœ… Sistema de seguranÃ§a JWT completo
- âœ… CRUD operations otimizadas
- âœ… Pydantic v2 atualizado
- âœ… Estrutura de projeto melhorada

### v1.0.0 - VersÃ£o Inicial
- âœ… API bÃ¡sica de usuÃ¡rios
- âœ… OperaÃ§Ãµes CRUD simples
- âœ… DocumentaÃ§Ã£o automÃ¡tica